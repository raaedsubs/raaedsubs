<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>موقع المحتوى مع التسجيل</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Reset */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body, h1, h2, h3, p, a, table, th, td {
            font-family: 'Tajawal', sans-serif;
        }

        body {
            background-color: #f4f4f4;
            color: #333;
            line-height: 1.6;
            font-size: 16px;
            padding: 20px;
            direction: rtl;  /* دعم الكتابة من اليمين لليسار */
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .login-screen, .content-screen {
            display: none;
        }

        .login-screen.active, .content-screen.active {
            display: block;
        }

        input[type="text"], input[type="password"], input[type="email"], input[type="submit"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        .error-message {
            color: red;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        table {
            width: 100%;
            margin-top: 30px;
            border-collapse: collapse;
        }

        th, td {
            padding: 10px;
            text-align: right;
            border: 1px solid #ddd;
        }

        th {
            background-color: #f2f2f2;
        }

        .pagination button {
            padding: 8px 12px;
            margin: 5px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .pagination button.active {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>موقع المحتوى مع التسجيل</h1>
        </header>

        <!-- شاشة تسجيل الدخول -->
        <div id="login-screen" class="login-screen active">
            <h2>تسجيل الدخول</h2>
            <form id="login-form">
                <input type="email" id="login-email" placeholder="البريد الإلكتروني" required>
                <input type="password" id="login-password" placeholder="كلمة المرور" required>
                <button type="submit">تسجيل الدخول</button>
                <p class="error-message" id="login-error"></p>
            </form>
            <button onclick="showSignupScreen()">إنشاء حساب جديد</button>
        </div>

        <!-- شاشة التسجيل -->
        <div id="signup-screen" class="login-screen">
            <h2>إنشاء حساب</h2>
            <form id="signup-form">
                <input type="email" id="signup-email" placeholder="البريد الإلكتروني" required>
                <input type="text" id="signup-username" placeholder="اسم المستخدم" required>
                <input type="password" id="signup-password" placeholder="كلمة المرور" required>
                <button type="submit">إنشاء حساب</button>
                <p class="error-message" id="signup-error"></p>
            </form>
            <button onclick="showLoginScreen()">لديك حساب؟ تسجيل الدخول</button>
        </div>

        <!-- شاشة المحتوى -->
        <div id="content-screen" class="content-screen">
            <h2>المحتوى</h2>
            <table id="content-table">
                <thead>
                    <tr>
                        <th>الاسم</th>
                        <th>النوع</th>
                        <th>عدد الحلقات</th>
                        <th>الحالة</th>
                        <th>رابط الترجمة</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>

            <div id="pagination" class="pagination"></div>
        </div>
    </div>

    <script>
        const loginForm = document.getElementById('login-form');
        const signupForm = document.getElementById('signup-form');
        const loginEmail = document.getElementById('login-email');
        const loginPassword = document.getElementById('login-password');
        const signupEmail = document.getElementById('signup-email');
        const signupUsername = document.getElementById('signup-username');
        const signupPassword = document.getElementById('signup-password');
        const loginError = document.getElementById('login-error');
        const signupError = document.getElementById('signup-error');
        const contentScreen = document.getElementById('content-screen');
        const loginScreen = document.getElementById('login-screen');
        const signupScreen = document.getElementById('signup-screen');
        const contentTable = document.getElementById('content-table').getElementsByTagName('tbody')[0];
        const pagination = document.getElementById('pagination');

        let currentPage = 1;
        const itemsPerPage = 20;

        // الدالة لإظهار شاشة التسجيل
        function showSignupScreen() {
            signupScreen.classList.add('active');
            loginScreen.classList.remove('active');
        }

        // الدالة لإظهار شاشة الدخول
        function showLoginScreen() {
            loginScreen.classList.add('active');
            signupScreen.classList.remove('active');
        }

        // الدالة لإظهار شاشة المحتوى
        function showContentScreen() {
            contentScreen.classList.add('active');
            loginScreen.classList.remove('active');
            signupScreen.classList.remove('active');
        }

        // تسجيل الدخول
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const email = loginEmail.value;
            const password = loginPassword.value;

            fetch('https://sheetdb.io/api/v1/clr7339juzcwd')
                .then(response => response.json())
                .then(data => {
                    const user = data.find(user => user.email === email && user.password === password);
                    if (user) {
                        localStorage.setItem('user', JSON.stringify(user));
                        showContentScreen();
                    } else {
                        loginError.textContent = 'البريد الإلكتروني أو كلمة المرور غير صحيحة';
                    }
                })
                .catch(error => console.error('Error:', error));
        });

        // إنشاء حساب
        signupForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const email = signupEmail.value;
            const username = signupUsername.value;
            const password = signupPassword.value;

            if (!/\S+@\S+\.\S+/.test(email)) {
                signupError.textContent = 'البريد الإلكتروني غير صالح';
                return;
            }

            fetch('https://sheetdb.io/api/v1/clr7339juzcwd', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    data: [
                        {
                            email: email,
                            username: username,
                            password: password
                        }
                    ]
                })
            })
            .then(response => response.json())
            .then(data => {
                alert('تم إنشاء الحساب بنجاح!');
                showLoginScreen();
            })
            .catch(error => console.error('Error:', error));
        });

        // جلب المحتوى من API
        function fetchData() {
            fetch('https://sheetdb.io/api/v1/jk0nwvej372zt')
                .then(response => response.json())
                .then(data => {
                    renderContent(data);
                    renderPagination(data.length);
                })
                .catch(error => console.error('Error:', error));
        }

        // عرض المحتوى في الجدول
        function renderContent(data) {
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const currentPageData = data.slice(start, end);
            contentTable.innerHTML = '';
            currentPageData.forEach(item => {
                const row = contentTable.insertRow();
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.type}</td>
                    <td>${item.episodes}</td>
                    <td>${item.status}</td>
                    <td><a href="${item.translationLink}">رابط الترجمة</a></td>
                `;
            });
        }

        // عرض الترقيم
        function renderPagination(totalItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            pagination.innerHTML = '';

            for (let i = 1; i <= totalPages; i++) {
                const button = document.createElement('button');
                button.textContent = i;
                button.classList.toggle('active', i === currentPage);
                button.addEventListener('click', () => {
                    currentPage = i;
                    fetchData();
                });
                pagination.appendChild(button);
            }
        }

        // بدء جلب البيانات عند فتح الموقع
        if (localStorage.getItem('user')) {
            showContentScreen();
            fetchData();
        } else {
            showLoginScreen();
        }
    </script>
</body>
</html>
